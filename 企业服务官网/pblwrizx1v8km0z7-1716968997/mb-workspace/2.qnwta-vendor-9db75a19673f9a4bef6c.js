"use strict";(self.webpackChunk_mb2023_mb_workspace=self.webpackChunk_mb2023_mb_workspace||[]).push([[609],{36408:function(){var F={}},4060:function(F,D,e){e.d(D,{f:function(){return _}});var M=e(69793),_=M.default.div.withConfig({displayName:"styles__StyledAppContainer",componentId:"sc-8844k3-0"})(["flex:1;overflow:hidden;position:relative;.app-placeholder{position:relative;min-width:100%;min-height:100%;display:flex;justify-content:center;align-items:center;.app-content{background:black;&.hide-back{background:inherit;}}&.wait-drag{cursor:grab;}}"])},6690:function(F,D,e){e.d(D,{W:function(){return S}});var M=e(69793),_=e(12105),S=M.default.div.withConfig({displayName:"styles__StyledSquareLeftPanel",componentId:"sc-1nwb7ql-0"})(['position:relative;.screen-panel{width:100%;height:100%;display:flex;flex-direction:column;background-color:#F7F7F7;overflow:hidden;.screen-header{display:flex;padding:8px 12px;justify-content:space-between;align-items:center;background-color:#363738;.title{font-weight:900;font-size:12px;line-height:17px;color:#FFFFFF;}.toggle-icon{width:16px;color:#363738;cursor:pointer;&:hover{path{stroke:#0099FF;}}}}.screen-search{padding:8px;[type="search"]{flex:1;}input{background-color:',";border-color:",";border-radius:4px;}}.screen-count{display:flex;padding:8px;justify-content:space-between;align-items:center;.info{font-weight:700;font-size:10px;line-height:14px;color:#333333;}.expand-button{font-weight:400;font-size:10px;line-height:14px;color:#0099FF;cursor:pointer;}}.screen-list-container{flex:1;overflow-x:hidden;overflow-y:auto;.thumbnail-list{padding:10px;.thumbnail-item{width:158px;height:158px;padding:6px;border-radius:7px;box-sizing:border-box;border:3px solid transparent;cursor:pointer;&:hover{border-color:",";}&.active{border:3px solid ",";}.image-wrapper{background:url(",");width:100%;height:100%;border-radius:4px;object-fit:cover;overflow:hidden;border-width:0px;padding:0px;&:hover{border-width:0px;padding:0px;}&.active{border-width:0px;padding:0px;}img{width:100%;height:100%;object-fit:contain;}.screen-name{font-size:12px;line-height:17px;color:#1f292e;text-align:center;margin:5px 0;}}}}}}.border-resizer.right{position:absolute;right:-1px;&:hover{background-color:rgba(22,132,252,.6);}&.active{background-color:rgba(22,132,252,.6);}}"],function(E){return E.theme.color_background_white},function(E){return E.theme.color_background_white},function(E){return E.theme.color_text_disabled},function(E){return E.theme.color_primary_proto01},_.r)},21075:function(F,D,e){var M=e(69793),_=M.default.div.withConfig({displayName:"style__StyledSquareOptionList",componentId:"sc-grea7k-0"})(["position:absolute;left:16px;top:16px;.option-list-wrapper{background:#fff;box-shadow:0 2px 6px rgba(39,54,78,0.08);border-radius:2px;pointer-events:auto;width:32px;height:36px;overflow-y:hidden;&.isExpand{height:100%;overflow:unset;}&.shell-wrapper{margin:16px 0 0 0;.svg-icon{width:24px;height:24px;}}}.nav{border-radius:0 0 2px 2px;&:hover{border:2px solid rgb(22,132,252);}.svg-icon{width:24px;height:24px;}& > .svg-icon path{fill:#fff;}}.expand-btn{display:flex;justify-content:center;width:32px;height:20px;margin:4px 0 0 0;background:#fff;box-shadow:0 2px 6px rgba(39,54,78,0.08);border-radius:4px;cursor:pointer;.svg-icon{transition:all 0.2s ease-in-out;&.isExpand{transform:rotate(-180deg);}}}.command-wrapper{height:36px;display:flex;justify-content:center;align-items:center;cursor:pointer;&:first-child{border-radius:2px 2px 0 0;}&:hover{background:#e8e8e8;}&.active{background:#1684fc;.svg-icon path{fill:#fff !important;}}}.wrapper-top{margin-bottom:8px;border-radius:2px;background:",";box-shadow:0 2px 10px 0 rgba(39,54,78,0.08),0 12px 40px 0 rgba(39,54,78,0.1);}.locate{width:12px;height:16px;}.rotate{width:16px;height:16px;}.link{width:11px;height:16px;}.sticky-icon{width:14px;height:16px;}"],function(S){return S.theme.color_background_white});D.Z=_},42923:function(F,D,e){e.d(D,{$k:function(){return _},AX:function(){return M},Pw:function(){return S}});var M=184,_=520,S=184},66192:function(F,D,e){e.d(D,{a:function(){return _}});var M=e(69793),_=M.default.div.withConfig({displayName:"styles__StyledApp",componentId:"sc-72l7dj-0"})(["width:100%;height:100%;display:flex;background:",";"],function(S){return S.theme.color_background_icon_hover})},14356:function(F,D,e){e.d(D,{Z:function(){return r}});var M=e(29442),_=e(21882),S=e(94975),E=e(56667),B=e(53485),g=e(38899),H=e(68101),u=e(20018),W=e(7485),m=e(7627),f=e.n(m),b=e(35136),C=e(98743),y=e(24248),T=e(74079),K=e(43977),L=e(55479),R=e(57690),U=e(66216),I=e(63160),d=e(76637),j=e(24011),x=e(66192),p=e(35269);function a(i,n,h){return n=(0,B.Z)(n),(0,S.Z)(i,(0,E.Z)()?Reflect.construct(n,h||[],(0,B.Z)(i).constructor):n.apply(i,h))}var r=function(i){(0,H.Z)(n,i);function n(){var h;(0,M.Z)(this,n);for(var l=arguments.length,o=new Array(l),t=0;t<l;t++)o[t]=arguments[t];return h=a(this,n,[].concat(o)),(0,u.Z)((0,g.Z)(h),"keyboardManager",new U.Sm),h}return(0,_.Z)(n,[{key:"preventDefault",value:function(l){l.preventDefault()}},{key:"render",value:function(){var l=this.props,o=l.previewOptions,t=l.previewSetting,c=o.isSquare,v=o.isEmbedV2,A=t.isFullScreenMode,s=A,O=c&&!s,P=v;return(0,p.jsx)(U.XC.Provider,{value:this.keyboardManager,children:(0,p.jsx)(j.Z,{children:(0,p.jsxs)(x.a,{onContextMenu:this.preventDefault,children:[s&&(0,p.jsx)(K.Z,{}),O&&(0,p.jsx)(C.Z,{}),P&&(0,p.jsx)(T.Z,{}),(0,p.jsx)(b.Z,{}),(0,p.jsx)(y.Z,{mode:L.t.isEmbed}),(0,p.jsx)(d.NM,{sheet:I.R}),(0,p.jsx)(R.F,{})]})})})}}]),n}(W.PureComponent);(0,u.Z)(r,"propTypes",{previewOptions:f().object,previewSetting:f().object})},18681:function(F,D,e){e.d(D,{Z:function(){return h}});var M=e(29442),_=e(21882),S=e(94975),E=e(56667),B=e(53485),g=e(38899),H=e(68101),u=e(20018),W=e(7627),m=e.n(W),f=e(7485),b=e(9430),C=e(34595),y=e.n(C),T=e(48483),K=e(70721),L=e(60747),R=e(33258),U=e(4060),I=e(6250),d=e(81308),j=e(40356),x=e(121),p=e(67776),a=e(62059),r=e(41768),i=e(35269);function n(l,o,t){return o=(0,B.Z)(o),(0,S.Z)(l,(0,E.Z)()?Reflect.construct(o,t||[],(0,B.Z)(l).constructor):o.apply(l,t))}var h=function(l){(0,H.Z)(o,l);function o(){var t;(0,M.Z)(this,o);for(var c=arguments.length,v=new Array(c),A=0;A<c;A++)v[A]=arguments[A];return t=n(this,o,[].concat(v)),(0,u.Z)((0,g.Z)(t),"state",{isDraggingCanvas:!1}),(0,u.Z)((0,g.Z)(t),"setElementRef",function(s){return t.$elem=s}),(0,u.Z)((0,g.Z)(t),"handleKeyDown",function(s){var O=t.props.dispatch,P=s.target.matches("input")||s.target.matches("textarea"),w=s.keyCode===32;w&&!P&&(s.preventDefault(),O({type:"preview:set:key:flags",payload:{isSpaceDown:!0}}))}),(0,u.Z)((0,g.Z)(t),"handleKeyUp",function(){t.props.dispatch({type:"preview:reset:key:flags"})}),(0,u.Z)((0,g.Z)(t),"handleWheel",function(s){var O=t.props,P=O.scale,w=O.dispatch,$=O.canvasOffset,Z=$.x,N=$.y,V=t.state.isDisabled;if(!V){s.preventDefault();var X=Math.max(-1,Math.min(s.deltaY,1));if(s.ctrlKey||s.metaKey){var G=t.$elem.getBoundingClientRect(),re=G.top,ve=G.left,ne=G.right,Q=G.bottom,ce=(ve+ne)/2,pe=(re+Q)/2,q=P<=100?P-X*5:P-P*X*.05,ae=s.pageX-ce,Y=s.pageY-pe;q=Math.min(Math.max(q,r.vL),r.Fv);var ie=q/P;if(ie===1)return;var Ee=ae+ie*(Z-ae),se=Y+ie*(N-Y),ue={x:Ee,y:se};w({type:"entry:preview:set:scale",payload:{scale:q}}),w({type:"preview:set:canvas:offset",payload:{offset:ue}})}else w({type:"preview:set:canvas:offset",payload:{offset:{x:Z-s.deltaX,y:N-s.deltaY}}})}}),(0,u.Z)((0,g.Z)(t),"handleMouseDown",function(s){var O=t.props,P=O.isSpaceDown,w=O.previewOptions.isEmbedV2;s.button===1||s.button===2?(t.initDraggingCanvas(s),w&&(0,a.U1)("embed_share_links_click",{operation_type:"\u62D6\u52A8\u753B\u5E03"})):P&&(t.initDraggingCanvas(s),w&&(0,a.U1)("embed_share_links_click",{operation_type:"\u62D6\u52A8\u753B\u5E03"}))}),t}return(0,_.Z)(o,[{key:"componentDidMount",value:function(){this.$elem.addEventListener("wheel",this.handleWheel,{passive:!1}),this.$elem.addEventListener("mousedown",this.handleMouseDown,{passive:!1})}},{key:"componentWillUnmount",value:function(){this.$elem.removeEventListener("wheel",this.handleWheel,{passive:!1}),this.$elem.removeEventListener("mouseDown",this.handleMouseDown,{passive:!1})}},{key:"initDraggingCanvas",value:function(c){var v=this,A=c.clientX,s=c.clientY,O=this.props,P=O.canvasOffset,w=P.x,$=P.y,Z=O.dispatch;this.setState({isDraggingCanvas:!0});var N=function(G){var re={x:w+(G.clientX-A),y:$+(G.clientY-s)};Z({type:"preview:set:canvas:offset",payload:{offset:re}})},V=function X(){v.setState({isDraggingCanvas:!1}),document.removeEventListener("mousemove",N),document.removeEventListener("mouseup",X)};document.addEventListener("mousemove",N),document.addEventListener("mouseup",V)}},{key:"render",value:function(){var c=this.props,v=c.scale,A=c.project,s=c.screenGlue,O=c.screen,P=c.isShowShell,w=c.simulatorType,$=c.previewOptions,Z=c.isStickyShow,N=c.canvasOffset,V=c.isSpaceDown,X=c.annotateBtnShow,G=c.zoomOptionBarRight,re=c.dispatch,ve=this.state.isDraggingCanvas,ne=v/100,Q=O.orientation==="landscape",ce=w==="device"&&P?(0,L.uL)(A):"none",pe=N.x,q=N.y,ae=(0,L.sD)(A,ce,Q,$.isSquare),Y=ae.width,ie=ae.height,Ee={width:Y*ne,height:ie*ne,transform:"matrix(1, 0, 0, 1, "+Math.round(pe)+", "+Math.round(q)+")"},se={transform:"scale("+ne+")",width:Q?s.height:s.width,height:Q?s.width:s.height},ue=$.isSquare,oe=$.isEmbedV2;w!=="device"&&(se.height=Math.min(se.height,O.height));var _e=(0,R.SZ)({screenGlue:s,screen:O,project:A}),J=ue||oe;return(0,i.jsxs)(U.f,{ref:this.setElementRef,children:[(0,i.jsx)("div",{className:y()("app-placeholder",{"wait-drag":V||ve}),style:Ee,children:(0,i.jsxs)("div",{className:y()("app-content",!_e&&"hide-back"),style:se,children:[(0,i.jsx)(K.Z,{isShellShow:_e}),_e&&(0,i.jsx)(T.Z,{isHTMLZip:!1,project:A,shellType:ce,isLandscape:Q}),Z&&(0,i.jsx)(I.Z,{})]})}),oe&&(0,i.jsx)(p.Z,{}),J&&(0,i.jsx)(j.Z,{isEmbedV2:oe}),J&&(0,i.jsx)(d.Z,{isEmbedV2:oe,zoomOptionBarRight:G}),(0,i.jsx)(x.Z,{isShowResetButton:!1,annotateBtnShow:X,dispatch:re}),(0,i.jsx)(b.Z,{target:document,onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp})]})}}]),o}(f.PureComponent);(0,u.Z)(h,"propTypes",{simulatorType:m().string,scale:m().number,screen:m().object,project:m().object,screenGlue:m().object,isShowShell:m().bool,isStickyShow:m().bool,dispatch:m().func,previewOptions:m().object,canvasOffset:m().object,isSpaceDown:m().bool,annotateBtnShow:m().bool,zoomOptionBarRight:m().number})},35136:function(F,D,e){var M=e(89870),_=e(77200),S=e(18681);D.Z=(0,M.connect)(function(E){var B=(0,_.z7)(E),g=(0,_.CL)(E),H=(0,_.vo)(E),u=(0,_.ku)(E),W=(0,_.HR)(E),m=(0,_.ki)(E),f=(0,_.GP)(E),b=(0,_.EZ)(E),C=(0,_._L)(E),y=(0,_.W9)(E),T=(0,_.H9)(E),K=!(C.x===T.x&&C.y===T.y),L=(0,_.Dx)(E),R=(0,_.JH)(E),U=R.annotateSortList,I=R.show,d=(0,_.oD)(E),j=!L&&U.length>0&&b,x=I?d+16:16;return{scale:B,screen:g,project:H,screenGlue:u,simulatorType:W,isShowShell:m,previewOptions:f,isStickyShow:b,canvasOffset:C,isSpaceDown:y,isDisplaced:K,annotateBtnShow:j,zoomOptionBarRight:x}})(S.Z)},98743:function(F,D,e){var M=e(29442),_=e(21882),S=e(94975),E=e(56667),B=e(53485),g=e(38899),H=e(68101),u=e(20018),W=e(7485),m=e(7627),f=e.n(m),b=e(89870),C=e(84448),y=e(512),T=e(77200),K=e(12886),L=e(77711),R=e(42923),U=e(86281),I=e(6690),d=e(35269);function j(a,r,i){return r=(0,B.Z)(r),(0,S.Z)(a,(0,E.Z)()?Reflect.construct(r,i||[],(0,B.Z)(a).constructor):r.apply(a,i))}var x=(0,C.P1)([T.Eg],function(a){return a.filter(function(r){return!(0,y.Vx)(r)}).length}),p=function(a){(0,H.Z)(r,a);function r(i){var n;return(0,M.Z)(this,r),n=j(this,r,[i]),(0,u.Z)((0,g.Z)(n),"handleWidthChange",function(h){n.setState({screenListWidth:h})}),n.state={screenListWidth:R.Pw},n}return(0,_.Z)(r,[{key:"render",value:function(){var n=this.props.screensCount,h=this.state.screenListWidth;return(0,d.jsxs)(I.W,{style:{width:h},children:[(0,d.jsx)(U.Z,{isHTMLZip:!1,screensCount:n,from:K.j.community}),(0,d.jsx)(L.Z,{placement:"right",className:"v-resizer",value:h,min:R.AX,max:R.$k,onChange:this.handleWidthChange})]})}}]),r}(W.PureComponent);(0,u.Z)(p,"propTypes",{screensCount:f().number}),D.Z=(0,b.connect)(function(a){return{screensCount:x(a)}})(p)},40356:function(F,D,e){var M=e(29442),_=e(21882),S=e(94975),E=e(56667),B=e(53485),g=e(38899),H=e(68101),u=e(20018),W=e(7485),m=e(7627),f=e.n(m),b=e(89870),C=e(21075),y=e(16015),T=e(13666),K=e(34595),L=e.n(K),R=e(71452),U=e(41773),I=e(62059),d=e(35269);function j(p,a,r){return a=(0,B.Z)(a),(0,S.Z)(p,(0,E.Z)()?Reflect.construct(a,r||[],(0,B.Z)(p).constructor):a.apply(p,r))}var x=function(p){(0,H.Z)(a,p);function a(){var r;(0,M.Z)(this,a);for(var i=arguments.length,n=new Array(i),h=0;h<i;h++)n[h]=arguments[h];return r=j(this,a,[].concat(n)),(0,u.Z)((0,g.Z)(r),"state",{isExpand:!1}),(0,u.Z)((0,g.Z)(r),"handleToggleHighlight",function(){var l=r.props,o=l.isHighlight,t=l.isEmbedV2,c=o?"\u9AD8\u4EAE\u663E\u793A\u5173":"\u9AD8\u4EAE\u663E\u793A\u5F00";r.props.dispatch({type:"entry:preview-setting:update:is-highlight",payload:{isHighlight:!o}}),t&&(0,I.U1)("embed_share_links_click",{operation_type:c})}),(0,u.Z)((0,g.Z)(r),"handleToggleStatePanel",function(){var l=r.props,o=l.dispatch,t=l.isEmbedV2,c=l.isStatePanelShow;if(t){o({type:"entry:preview-setting:update:is-statePanel-show",payload:{isStatePanelShow:!c}});var v=c?"\u72B6\u6001\u9762\u677F\u5173":"\u72B6\u6001\u9762\u677F\u5F00";(0,I.U1)("embed_share_links_click",{operation_type:v})}}),(0,u.Z)((0,g.Z)(r),"handleToggleSticky",function(){var l=r.props,o=l.isStickyShow,t=l.isEmbedV2,c=o?"\u6279\u6CE8\u9690\u85CF":"\u6279\u6CE8\u663E\u793A";r.props.dispatch({type:"entry:preview-setting:update:is-sticky-show",payload:{isStickyShow:!o}}),r.props.dispatch({type:"reducer:toggle:annotatePanelShow"}),t&&(0,I.U1)("embed_share_links_click",{operation_type:c})}),(0,u.Z)((0,g.Z)(r),"handleExpandList",function(){var l=r.props.isEmbedV2;r.setState({isExpand:!r.state.isExpand}),l&&(0,I.U1)("embed_share_links_click",{operation_type:"\u4E0B\u62C9\u83DC\u5355\u70B9\u51FB"})}),(0,u.Z)((0,g.Z)(r),"handleToggleShellType",function(){var l=r.props,o=l.isShowShell,t=l.dispatch,c=!o;t({type:"entry:preview-setting:update:show:shell",payload:{isShowShell:c}})}),r}return(0,_.Z)(a,[{key:"render",value:function(){var i=this.props,n=i.isHighlight,h=i.isStickyShow,l=i.isStickyAvailable,o=i.dispatch,t=i.simulatorType,c=i.isShowOutsideArtboardNav,v=i.isShowShell,A=i.project,s=i.isEmbedV2,O=i.isStatePanelShow,P=this.state.isExpand,w=t==="device";return(0,d.jsxs)(C.Z,{children:[s&&(0,d.jsx)(T.Z,{content:I18N.pMainContent.statePanel,direction:"right",children:(0,d.jsx)("a",{className:L()("command-wrapper wrapper-top",{active:O}),onClick:this.handleToggleStatePanel,children:(0,d.jsx)(y.q,{name:"art_board/state",style:{fontSize:"24px"}})})}),(0,d.jsxs)("div",{className:L()("option-list-wrapper",{isExpand:P}),children:[(0,d.jsx)(T.Z,{content:I18N.pSquareOptionsList.highlighted,direction:"left",children:(0,d.jsx)("div",{className:L()("command-wrapper",{active:n}),onClick:this.handleToggleHighlight,children:(0,d.jsx)(y.q,{name:"square/preview/link",className:"link"})})}),l&&(0,d.jsx)(T.Z,{content:I18N.pMainContent.sticky_visible,direction:"left",children:(0,d.jsx)("div",{className:L()("command-wrapper",{active:h}),onClick:this.handleToggleSticky,children:(0,d.jsx)(y.q,{name:"square/preview/sticky",className:"sticky-icon"})})}),(0,d.jsx)(R.Z,{isInspect:!1,simulatorType:t,isShowOutsideArtboardNav:c,dispatch:o,isEmbedV2:s})]}),P&&w&&(0,d.jsx)("div",{className:"option-list-wrapper shell-wrapper",children:(0,d.jsx)(T.Z,{content:v?""+(0,U.F)(A):I18N.pMainContent.hide_border,direction:"right",children:(0,d.jsx)("div",{className:L()("command-wrapper","shell",{active:v}),onClick:this.handleToggleShellType,children:v?(0,d.jsx)(y.q,{name:"art_board/shell/open"}):(0,d.jsx)(y.q,{name:"art_board/shell/close"})})})}),(0,d.jsx)("div",{className:"expand-btn",onClick:this.handleExpandList,children:(0,d.jsx)(y.q,{name:"common/triangle-down",className:L()({isExpand:P})})})]})}}]),a}(W.PureComponent);(0,u.Z)(x,"propTypes",{isHighlight:f().bool,isStickyShow:f().bool,simulatorType:f().string,isStickyAvailable:f().bool,isShowOutsideArtboardNav:f().bool,isShowShell:f().bool,isEmbedV2:f().bool,isStatePanelShow:f().bool,project:f().object,dispatch:f().func}),D.Z=(0,b.connect)(function(p){var a=p.container.previewSetting.isHighlight,r=p.container.previewSetting.isStickyShow,i=p.container.previewSetting.isStickyAvailable,n=p.container.previewSetting.simulatorType,h=p.container.previewSetting.isShowOutsideArtboardNav,l=p.container.previewSetting.isShowShell,o=p.container.current.rootProject,t=p.container.previewSetting.isStatePanelShow;return{isHighlight:a,isStickyShow:r,isStickyAvailable:i,simulatorType:n,isShowOutsideArtboardNav:h,isShowShell:l,project:o,isStatePanelShow:t}})(x)},85820:function(F,D,e){e.d(D,{b:function(){return m}});var M=e(64555),_=e(72005),S=e(46198),E=e(43980),B=e(86225),g=e(39797),H=e(38625),u=e(20702),W=e(33779),m=function(){var f=(0,_.Z)((0,M.Z)().mark(function b(C){var y,T,K,L,R,U,I,d,j,x,p,a,r,i,n,h,l,o,t,c,v,A,s,O,P,w;return(0,M.Z)().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return y=C.initialData,T=C.previewOptions,K=C.api,L=C.initStoreRelated,R=C.projectAccessToken,U=C.projectEncryptedPassword,I=C.isPasswordRequired,d=C.$root,j={isDesign:!0,isExperience:!1,isLoggedExperience:!1,isOnPremises:!!y.is_on_premises,isWonderShare:!!y.is_wonder_share},x=(0,B.D)({api:K,initialData:y,popupHelper:(0,g.A)(),previewOptions:T,designOptions:j,initStoreRelated:L}),p=x.requestData,a=x.renderPreview,r=performance.now(),I&&setTimeout(function(){return(0,H.CQ)("\u5BC6\u7801\u67E5\u770B-\u9700\u8F93\u5165\u5BC6\u7801")},0),Z.next=7,p({projectAccessToken:R,projectEncryptedPassword:U,isPasswordRequired:I});case 7:i=Z.sent,n=i.projectAlike,h=i.projectMeta,l=performance.now(),o=Math.ceil((l-r)/1e3);try{W.xd.trackViewSharing({project_type:"\u539F\u578B",load_time:o,project_name:n.name,project_cid:n.cid,view_by:(0,u.QS)(),sign_in_out:(t=MB)!=null&&(t=t.user)!=null&&t.id?1:0,view_permission:MB.canEditByCurrentUser?"\u53EF\u7F16\u8F91":"\u4EC5\u67E5\u770B",my_project:((c=((n==null?void 0:n.permissions)||[]).find(function(N){var V;return N.user_id===((V=MB)==null||(V=V.user)==null?void 0:V.id)}))==null?void 0:c.role)==="project_owner"?1:0})}catch(N){(0,E.Tb)(N)}T!=null&&T.isMobile&&n&&(v=n.scene_tag,A=n.device,s=n.width,O=n.height,(0,W.ms)({scene_tag:v,device:A,width:s,height:O,project_type:"V7"})),P=location.hash||"",w=P&&P.startsWith("#screen=")&&P.substr(8),S.render(a(n,h,w),d);case 17:case"end":return Z.stop()}},b)}));return function(C){return f.apply(this,arguments)}}()},86225:function(F,D,e){e.d(D,{D:function(){return r}});var M=e(64555),_=e(72005),S=e(8836),E=e(7485),B=e(46496),g=e(14730),H=e(21586),u=e(21772),W=e(62059),m=e(91449),f=e(38625),b=e(70956),C=e(78467),y=e(78575),T=e(32449),K=e(23555),L=e(55223),R=e(86185),U=e(58057),I=e(66216),d=e(24011),j=e(33038),x=e(35269),p=window,a=p.MB;a.f.inSharing=!0;var r=function(n){var h=n.initialData,l=n.designOptions,o=n.previewOptions,t=n.popupHelper,c=n.initStoreRelated,v=n.api,A=v.requestProjectFullDataByAccessToken,s=v.requestSketchArtboardList,O=v.requestSketchArtboardById,P=v.requestSliceByArtboardId,w=v.requestSliceZipByArtboardId,$=v.checkSharingPermission,Z=v.fetchProjectComment,N=v.fetchProjectScreenCommentThreadCountMap,V=v.requestProjectShare,X=v.requestUserCommonGuidesData,G=v.updateUserCommonGuidesData,re=v.fetchCreateCommentThread,ve=v.fetchCreateComment,ne=v.fetchDeleteCommentThread,Q=v.fetchDeleteComment,ce=v.updateProjectBasicsInfo,pe=o.isMobile,q=o.isIOSClient,ae=o.isStandAlone;a.config.minFS=(0,g.T_)(),(ae||q)&&(document.documentElement.style.height="100vh");var Y=(0,m.o)(K.Z),ie=Y.runnerController,Ee=Y.messageBucket,se=Y.webpackInterface,ue=Y.PreviewApp;return(0,L.J)({api:{requestSketchArtboardList:s,requestSketchArtboardById:O,requestSliceByArtboardId:P,requestSliceZipByArtboardId:w,checkSharingPermission:$,fetchProjectComment:Z,fetchProjectScreenCommentThreadCountMap:N,requestUserCommonGuidesData:X,updateUserCommonGuidesData:G,fetchCreateCommentThread:re,fetchCreateComment:ve,fetchDeleteCommentThread:ne,fetchDeleteComment:Q,updateProjectBasicsInfo:ce}}),Object.assign(a,{runnerController:ie,messageBucket:Ee,webpackInterface:se,global:{popupHelper:t,designOptions:l}}),a.webpackInterface.store.dispatch({type:"entry:init:preview:options",payload:{previewOptions:o}}),{requestData:function(){var oe=(0,_.Z)((0,M.Z)().mark(function J(Pe){var de,Me,me,k,fe,De,Ce,ee,Oe,xe,Re,Be,Te,Ue,le,Se,Le,ge,be,te,We,ye,Ke,je,Ae,Ze,Ne,Fe,we,He,Ie,Ve;return(0,M.Z)().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return de=Pe.projectAccessToken,Me=Pe.projectEncryptedPassword,me=Pe.isPasswordRequired,k=h.user,fe=h.org,De=h.preference,Ce=h.MBSketchPluginDownloadURL,ee=h.canEditByCurrentUser,Oe=c(k&&!pe?k.id:null),xe=Oe.autoSaver,Re=Oe.socketStore,Be=Oe.projectExchange,Te=Oe.snapshotStore,Object.assign(window,{AutoSaver:xe,ProjectExchange:Be,MBSketchPluginDownloadURL:Ce}),Te&&Object.assign(window,{SnapshotStore:Te}),z.next=7,Re.getSocketConnectPromise();case 7:return Ue=(0,y.sL)(A),z.next=10,Ue({projectAccessToken:de,projectEncryptedPassword:Me,isPasswordRequired:me});case 10:if(le=z.sent,le){z.next=13;break}return z.abrupt("return");case 13:return Se=le.projectMeta,Le=le.screenGlueList,ge=le.screenMetaList,be=le.projectScreenObjectList,te=le.projectBasic,z.next=16,V(te.cid,de);case 16:return We=z.sent,ye=We.projectShare,Ke=ee&&(Se.is_org_project?!(te!=null&&te.expired):!(te!=null&&te.expired)||k.apps.length<=k.free_projects_count),Object.assign(a,{user:k||{},canEditByCurrentUser:Ke,org:fe||void 0,tag:te.version,currentUserCanEdit:ee}),je=JSON.parse(JSON.stringify(ge)),Ae=ge,Ze=ye.screen_visible_switch,Ne=ye.screen_visible_list,Fe=Le.find(function(he){return he.type===T._H.PROJECT_MAIN}),we=Fe.cid,Ze&&(He=new Set(Ne),Ae=ge.filter(function(he){return he.screen_glue_cid!==we||He.has(he.cid)})),z.next=28,ProjectExchange.openProject({projectMeta:Se,screenGlueList:Le,screenMetaList:Ae,projectScreenObjectList:be});case 28:return Ie=(0,u.K)(te),a.webpackInterface.store.dispatch({type:"entry:state:init"}),(0,R.Z)(),document.title=(0,b.FQ)(Ie.name),Ve=ge.filter(function(he){return he.screen_glue_cid===we}),a.webpackInterface.store.dispatch({type:"preview:originalScreenMetaList:update",payload:{originalScreenMetaList:je}}),a.webpackInterface.store.dispatch({type:"preview:screenMetaList:set",payload:{screenMetaList:Ve}}),a.webpackInterface.store.dispatch({type:"preview:set:current-projectShare",payload:{projectShare:ye}}),a.webpackInterface.store.dispatch({type:"entry:init:preview:preference",payload:{preference:De||{}}}),k&&(0,W.$b)(k.id),z.abrupt("return",{projectAlike:Ie,projectMeta:Se});case 39:case"end":return z.stop()}},J)}));function _e(J){return oe.apply(this,arguments)}return _e}(),renderPreview:function(_e,J,Pe){var de=(0,U.rt)(J.cid).find(function(ee){return ee.type==="project-main"}),Me=(0,U.bO)(J.cid,de.cid),me=Me.find(function(ee){return ee.cid===Pe})||(0,H.o)(Me);if(!me){var k;return setTimeout(function(){return(0,f.CQ)("\u9875\u9762\u4E3A\u7A7A")},0),a==null||(k=a.messageBucket)==null||k.send("mobileLoadProjectError",{errMsg:I18N.dModule.zero_screen_err_title}),(0,x.jsx)(S.Z,{errorType:404,customTitle:I18N.dModule.zero_screen_err_title,customDes:I18N.dModule.zero_screen_err_des,isShowSecondaryBtn:!1,primaryClick:function(){return(0,C.HM)("zh-CN","\u539F\u578B-\u5206\u4EAB\u94FE\u63A5\u9875\u9762\u4E3A\u7A7A")}})}var fe=new I.Sm,De=new URLSearchParams(location.search),Ce=pe?"preview":De.has("inspect")?"inspect":De.has("comment")?"comment":"preview";return setTimeout(function(){(0,j.u0)()},1e3),(0,x.jsx)(I.XC.Provider,{value:fe,children:(0,x.jsx)(d.Z,{children:(0,x.jsx)(ue,{store:a.webpackInterface.store,previewMode:Ce,projectAlike:_e,projectMeta:J,screenGlue:de,screenMeta:me})})})}}}},46496:function(F,D,e){var M=e(5423),_=e(21202),S=e(36408);window.$=window.jQuery=e(8435),e(82888),e(34268),e(87645),e(22020),e(11460)}}]);

//# sourceMappingURL=2.qnwta-vendor-9db75a19673f9a4bef6c.js.map